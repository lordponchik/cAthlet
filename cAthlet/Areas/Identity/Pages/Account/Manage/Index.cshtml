@page
@model IndexModel
@{
	ViewData["Title"] = "Profile";
	ViewData["ActivePage"] = ManageNavPages.Index;
}


<div class="row">
	<div class="col-md-6">
		<form id="profile-form" method="post">
			<div class="verwalungskarte">

				<div class="datenbenutzer">
					<div class="form-floating mb-3">
						<label asp-for="Input.FirstName"></label>
						<input asp-for="Input.FirstName" class="form-control input" />
					</div>

					<div class="form-floating mb-3">
						<label asp-for="Input.LastName"></label>
						<input asp-for="Input.LastName" class="form-control input" />
					</div>

					<div class="form-floating mb-3">
						<label asp-for="Input.Age"></label>
						<input asp-for="Input.Age" type="number" class="form-control input" />
					</div>

					<div class="form-floating mb-3">
						<label asp-for="Input.Height"></label>
						<input asp-for="Input.Height" type="number" class="form-control input" />
					</div>

					<div class="form-floating mb-3">
						<label asp-for="Input.Weight"></label>
						<input asp-for="Input.Weight" type="number" class="form-control input" />
					</div>
					<div asp-validation-summary="ModelOnly" class="text-danger" role="alert"></div>

				</div>
				<div class="mb-3 bildbenutzer">
					<div id="image-container">
						<img id="profile-image" src="~/bilder/profiles/@Model.Input.ProfileImage" width="100px" class="img-thumbnail" alt="Profile Image" />
					</div>
					<button type="button" id="next-image" class="btn btn-secondary mt-2 nextbildbenutzer">Next</button>
					<input type="hidden" asp-for="Input.ProfileImage" />
				</div>

				<partial name="_StatusMessage" for="StatusMessage" />
			</div>
			<button id="update-profile-button" type="submit" class="w-100 btn btn-lg btn-primary">Save</button>
		</form>

	</div>
</div>


@section Scripts {
	<partial name="_ValidationScriptsPartial" />

	<script>
		const images = @Html.Raw(System.Text.Json.JsonSerializer.Serialize(Model.AvailableImages));
		let currentIndex = images.indexOf('@Model.Input.ProfileImage') || 0;

		const imgElement = document.getElementById('profile-image');
		const nextButton = document.getElementById('next-image');
		const hiddenInput = document.querySelector('input[name="Input.ProfileImage"]');

		nextButton.addEventListener('click', () => {
			currentIndex = (currentIndex + 1) % images.length;
			imgElement.src = '/bilder/profiles/' + images[currentIndex];
			hiddenInput.value = images[currentIndex];
		});
	</script>
}
